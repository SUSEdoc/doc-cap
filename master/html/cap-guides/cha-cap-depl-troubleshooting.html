<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Troubleshooting | Deployment, Administration, and User Guides | SUSE Cloud Application Platform 2.1.1</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="Troubleshooting | SUSE Cloud Application Platform 2.1.1" />
<meta name="description" content="Cloud stacks are complex, and debugging deployment issues often requires digging through multiple layers to find the information you need. Remember that the Ku…" />
<meta name="product-name" content="SUSE Cloud Application Platform" />
<meta name="product-number" content="2.1.1" />
<meta name="book-title" content="Deployment, Administration, and User Guides" />
<meta name="chapter-title" content="Chapter 27. Troubleshooting" />
<meta name="tracker-url" content="https://github.com/SUSE/doc-cap/issues/new" />
<meta name="tracker-type" content="gh" />
<meta name="tracker-gh-assignee" content="btat" />
<meta name="tracker-gh-labels" content="bug,low priority" />
<meta property="og:title" content="Troubleshooting | SUSE Cloud Application Platform 2.1.1" />
<meta property="og:description" content="Cloud stacks are complex, and debugging deployment issues often requires digging through multiple layers to find the information you need. Remember that the Ku…" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Troubleshooting | SUSE Cloud Application Platform 2.1.1" />
<meta name="twitter:description" content="Cloud stacks are complex, and debugging deployment issues often requires digging through multiple layers to find the information you need. Remember that the Ku…" />
<link rel="home" href="index.html" title="SUSE Cloud Application Platform 2.1.1 Documentation" /><link rel="up" href="part-cap-troubleshooting.html" title="Part V. Troubleshooting" /><link rel="prev" href="part-cap-troubleshooting.html" title="Part V. Troubleshooting" /><link rel="next" href="bk01apa.html" title="Appendix A. Appendix" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Deployment, Administration, and User Guides"><span class="book-icon">Deployment, Administration, and User Guides</span></a><span> › </span><a class="crumb" href="part-cap-troubleshooting.html">Troubleshooting</a><span> › </span><a class="crumb" href="cha-cap-depl-troubleshooting.html">Troubleshooting</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Deployment, Administration, and User Guides</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-deployment.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part-cap-overview.html"><span class="number">I </span><span class="name">Overview of SUSE Cloud Application Platform</span></a><ol><li class="inactive"><a href="cha-cap-overview.html"><span class="number">1 </span><span class="name">About SUSE Cloud Application Platform</span></a></li><li class="inactive"><a href="cha-cap-depl-kube-requirements.html"><span class="number">2 </span><span class="name">Other Kubernetes Systems</span></a></li></ol></li><li class="inactive"><a href="part-cap-deployment.html"><span class="number">II </span><span class="name">Deploying SUSE Cloud Application Platform</span></a><ol><li class="inactive"><a href="cha-cap-depl-notes.html"><span class="number">3 </span><span class="name">Deployment and Administration Notes</span></a></li><li class="inactive"><a href="cha-cap-depl-caasp.html"><span class="number">4 </span><span class="name">Deploying SUSE Cloud Application Platform on SUSE CaaS Platform</span></a></li><li class="inactive"><a href="cha-cap-depl-aks.html"><span class="number">5 </span><span class="name">Deploying SUSE Cloud Application Platform on Microsoft Azure Kubernetes Service (AKS)</span></a></li><li class="inactive"><a href="cha-cap-depl-eks.html"><span class="number">6 </span><span class="name">Deploying SUSE Cloud Application Platform on Amazon Elastic Kubernetes Service (EKS)</span></a></li><li class="inactive"><a href="cha-cap-depl-gke.html"><span class="number">7 </span><span class="name">Deploying SUSE Cloud Application Platform on Google Kubernetes Engine (GKE)</span></a></li><li class="inactive"><a href="cha-cap-install-stratos.html"><span class="number">8 </span><span class="name">Installing the Stratos Web Console</span></a></li><li class="inactive"><a href="cha-cap-depl-eirini.html"><span class="number">9 </span><span class="name">Eirini</span></a></li><li class="inactive"><a href="cha-cap-depl-terraform.html"><span class="number">10 </span><span class="name">Deploying SUSE Cloud Application Platform Using Terraform</span></a></li><li class="inactive"><a href="cha-cap-depl-air-gap-registry.html"><span class="number">11 </span><span class="name">Setting Up a Registry for an Air Gapped Environment</span></a></li><li class="inactive"><a href="cha-cap-depl-private-registry.html"><span class="number">12 </span><span class="name">SUSE Private Registry</span></a></li></ol></li><li class="inactive"><a href="part-cap-administration.html"><span class="number">III </span><span class="name">SUSE Cloud Application Platform Administration</span></a><ol><li class="inactive"><a href="cha-cap-upgrade.html"><span class="number">13 </span><span class="name">Upgrading SUSE Cloud Application Platform</span></a></li><li class="inactive"><a href="cha-cap-configuration-changes.html"><span class="number">14 </span><span class="name">Configuration Changes</span></a></li><li class="inactive"><a href="cha-cap-create-admin-user.html"><span class="number">15 </span><span class="name">Creating Admin Users</span></a></li><li class="inactive"><a href="cha-cap-manage-passwords.html"><span class="number">16 </span><span class="name">Managing Passwords</span></a></li><li class="inactive"><a href="cha-cap-uaa-ui.html"><span class="number">17 </span><span class="name">Accessing the UAA User Interface</span></a></li><li class="inactive"><a href="cha-cap-memory-limits.html"><span class="number">18 </span><span class="name">Container Memory Limits and Requests</span></a></li><li class="inactive"><a href="cha-cap-ccdb-secret-rotation.html"><span class="number">19 </span><span class="name">Cloud Controller Database Secret Rotation</span></a></li><li class="inactive"><a href="cha-cap-secrets-rotation.html"><span class="number">20 </span><span class="name">Rotating Automatically Generated Secrets</span></a></li><li class="inactive"><a href="cha-cap-backup-restore.html"><span class="number">21 </span><span class="name">Backup and Restore</span></a></li><li class="inactive"><a href="cha-cap-service-brokers.html"><span class="number">22 </span><span class="name">Service Brokers</span></a></li><li class="inactive"><a href="cha-cap-app-autoscaler.html"><span class="number">23 </span><span class="name">App-AutoScaler</span></a></li><li class="inactive"><a href="cha-cap-credhub.html"><span class="number">24 </span><span class="name">Integrating CredHub with SUSE Cloud Application Platform</span></a></li><li class="inactive"><a href="cha-cap-buildpacks.html"><span class="number">25 </span><span class="name">Buildpacks</span></a></li></ol></li><li class="inactive"><a href="part-cap-user-guide.html"><span class="number">IV </span><span class="name">SUSE Cloud Application Platform User Guide</span></a><ol><li class="inactive"><a href="cha-cap-cf-cli.html"><span class="number">26 </span><span class="name">Deploying and Managing Applications with the Cloud Foundry Client</span></a></li></ol></li><li class="inactive"><a href="part-cap-troubleshooting.html"><span class="number">V </span><span class="name">Troubleshooting</span></a><ol><li class="inactive"><a href="cha-cap-depl-troubleshooting.html"><span class="number">27 </span><span class="name">Troubleshooting</span></a></li></ol></li><li class="inactive"><a href="bk01apa.html"><span class="number">A </span><span class="name">Appendix</span></a></li><li class="inactive"><a href="bk01apb.html"><span class="number">B </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Part V. Troubleshooting" href="part-cap-troubleshooting.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Appendix A. Appendix" href="bk01apa.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Deployment, Administration, and User Guides"><span class="book-icon">Deployment, Administration, and User Guides</span></a><span> › </span><a class="crumb" href="part-cap-troubleshooting.html">Troubleshooting</a><span> › </span><a class="crumb" href="cha-cap-depl-troubleshooting.html">Troubleshooting</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Part V. Troubleshooting" href="part-cap-troubleshooting.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Appendix A. Appendix" href="bk01apa.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-cap-depl-troubleshooting"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname ">SUSE Cloud Application Platform</span> <span class="productnumber ">2.1.1</span></div><div><h2 class="title"><span class="number">27 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Troubleshooting</span> <a title="Permalink" class="permalink" href="cha-cap-depl-troubleshooting.html#">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_troubleshooting.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-logging"><span class="number">27.1 </span><span class="name">Logging</span></a></span></dt><dt><span class="sect1"><a href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-supportconfig"><span class="number">27.2 </span><span class="name">Using Supportconfig</span></a></span></dt><dt><span class="sect1"><a href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-toolong"><span class="number">27.3 </span><span class="name">Deployment Is Taking Too Long</span></a></span></dt><dt><span class="sect1"><a href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-rebuild-depl"><span class="number">27.4 </span><span class="name">Deleting and Rebuilding a Deployment</span></a></span></dt><dt><span class="sect1"><a href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-kubectl-queries"><span class="number">27.5 </span><span class="name">Querying with Kubectl</span></a></span></dt><dt><span class="sect1"><a href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-admission-webhook"><span class="number">27.6 </span><span class="name">Admission webhook denied</span></a></span></dt><dt><span class="sect1"><a href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-helm-namespace"><span class="number">27.7 </span><span class="name">Namespace does not exist</span></a></span></dt><dt><span class="sect1"><a href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-log-cache-memory"><span class="number">27.8 </span><span class="name">Log-cache Memory Allocation Issue</span></a></span></dt></dl></div></div><p>
  Cloud stacks are complex, and debugging deployment issues often requires
  digging through multiple layers to find the information you need. Remember
  that the KubeCF releases must be deployed in the correct order, and that each
  release must deploy successfully, with no failed pods, before deploying the
  next release.
 </p><p>
  Before proceeding with in depth troubleshooting, ensure the following have
  been met as defined in the Support Statement at <a class="xref" href="preface-deployment.html#sec-cap-platform-support" title="5.2. Platform Support">Section 5.2, “Platform Support”</a>.
 </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
     The Kubernetes cluster satisfies the Requirements listed here at
     <a class="link" href="https://documentation.suse.com/suse-cap/2.1.1/html/cap-guides/cha-cap-depl-kube-requirements.html#sec-cap-changes-kube-reqs" target="_blank">https://documentation.suse.com/suse-cap/2.1.1/html/cap-guides/cha-cap-depl-kube-requirements.html#sec-cap-changes-kube-reqs</a>.
    </p></li><li class="listitem "><p>
     The <code class="filename">kube-ready-state-check.sh</code> script has been run on
     the target Kubernetes cluster and does not show any configuration problems.
    </p></li><li class="listitem "><p>
     A SUSE Services or Sales Engineer has verified that SUSE Cloud Application Platform works
     correctly on the target Kubernetes cluster.
    </p></li></ol></div><div class="sect1 " id="sec-cap-tbl-logging"><div class="titlepage"><div><div><h2 class="title"><span class="number">27.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Logging</span> <a title="Permalink" class="permalink" href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-logging">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_troubleshooting.xml</li><li><span class="ds-label">ID: </span>sec-cap-tbl-logging</li></ul></div></div></div></div><p>
   There are two types of logs in a deployment of SUSE Cloud Application Platform, applications
   logs and component logs. The following provides a brief overview of each log
   type and how to retrieve them for monitoring and debugging use.
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
    Application logs provide information specific to a given application that
    has been deployed to your Cloud Application Platform cluster and can be accessed through:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      The cf CLI using the <code class="command">cf logs</code> command
     </p></li><li class="listitem "><p>
      The application's log stream within the Stratos console
     </p></li></ul></div></li><li class="listitem "><p>
    Access to logs for a given component of your Cloud Application Platform deployment can be
    obtained by:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      The <code class="command">kubectl logs</code> command
     </p><p>
      The following example retrieves the logs of the <code class="literal">router</code>
      container of <code class="literal">router-0</code> pod in the <code class="literal">kubecf</code>
      namespace
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl logs --namespace kubecf <em class="replaceable ">router-0</em> <em class="replaceable ">router</em></pre></div></li><li class="listitem "><p>
      Direct access to the log files using the following:
     </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
        Open a shell to the container of the component using the
        <code class="command">kubectl exec</code> command
       </p></li><li class="listitem "><p>
        Navigate to the logs directory at
        <code class="filename">/var/vcap/sys/logs</code>, at which point there will be
        subdirectories containing the log files for access.
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl exec --stdin --tty --namespace kubecf router-0 /bin/bash

router/0:/# cd /var/vcap/sys/log

router/0:/var/vcap/sys/log# ls -R
.:
gorouter  loggregator_agent

./gorouter:
access.log  gorouter.err.log  gorouter.log  post-start.err.log  post-start.log

./loggregator_agent:
agent.log</pre></div></li></ol></div></li></ul></div></li></ul></div></div><div class="sect1 " id="sec-cap-tbl-supportconfig"><div class="titlepage"><div><div><h2 class="title"><span class="number">27.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Using Supportconfig</span> <a title="Permalink" class="permalink" href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-supportconfig">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_troubleshooting.xml</li><li><span class="ds-label">ID: </span>sec-cap-tbl-supportconfig</li></ul></div></div></div></div><p>
   If you ever need to request support, or just want to generate detailed
   system information and logs, use the <code class="command">supportconfig</code>
   utility. Run it with no options to collect basic system information, and
   also cluster logs including Docker, etcd, flannel, and Velum.
   <code class="command">supportconfig</code> may give you all the information you need.
  </p><p>
   <code class="command">supportconfig -h</code> prints the options. Read the "Gathering
   System Information for Support" chapter in any SUSE Linux Enterprise <em class="citetitle ">Administration Guide</em> to
   learn more.
  </p></div><div class="sect1 " id="sec-cap-tbl-toolong"><div class="titlepage"><div><div><h2 class="title"><span class="number">27.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Deployment Is Taking Too Long</span> <a title="Permalink" class="permalink" href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-toolong">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_troubleshooting.xml</li><li><span class="ds-label">ID: </span>sec-cap-tbl-toolong</li></ul></div></div></div></div><p>
   A deployment step seems to take too long, or you see that some pods are not
   in a ready state hours after all the others are ready, or a pod shows a lot
   of restarts. This example shows not-ready pods many hours after the others
   have become ready:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get pods --namespace kubecf
NAME                     READY STATUS    RESTARTS  AGE
router-3137013061-wlhxb  0/1   Running   0         16h
routing-api-0            0/1   Running   0         16h</pre></div><p>
   The <code class="literal">Running</code> status means the pod is bound to a node and
   all of its containers have been created. However, it is not
   <code class="literal">Ready</code>, which means it is not ready to service requests.
   Use <code class="command">kubectl</code> to print a detailed description of pod events
   and status:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl describe pod --namespace kubecf router-0</pre></div><p>
   This prints a lot of information, including IP addresses, routine events,
   warnings, and errors. You should find the reason for the failure in this
   output.
  </p><div id="id-1.3.7.3.7.7" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important</h6><p>
  During deployment, pods are spawned over time, starting with a single
  pod whose name stars with <code class="literal">ig-</code>. This pod will eventually
  disappear and will be replaced by other pods whose progress
  then can be followed as usual.
 </p><p>
  The whole process can take around 20—30 minutes to finish.
 </p><p>
  The initial stage may look like this:
 </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get pods --namespace kubecf
ig-kubecf-f9085246244fbe70-jvg4z   1/21    Running             0          8m28s</pre></div><p>
  Later the progress may look like this:
 </p><div class="verbatim-wrap"><pre class="screen">NAME                        READY   STATUS       RESTARTS   AGE
adapter-0                   4/4     Running      0          6m45s
api-0                       0/15    Init:30/63   0          6m38s
bits-0                      0/6     Init:8/15    0          6m34s
bosh-dns-7787b4bb88-2wg9s   1/1     Running      0          7m7s
bosh-dns-7787b4bb88-t42mh   1/1     Running      0          7m7s
cc-worker-0                 0/4     Init:5/9     0          6m36s
credhub-0                   0/5     Init:6/11    0          6m33s
database-0                  2/2     Running      0          6m36s
diego-api-0                 6/6     Running      2          6m38s
doppler-0                   0/9     Init:7/16    0          6m40s
eirini-0                    9/9     Running      0          6m37s
log-api-0                   0/7     Init:6/13    0          6m35s
nats-0                      4/4     Running      0          6m39s
router-0                    0/5     Init:5/11    0          6m33s
routing-api-0               0/4     Init:5/10    0          6m42s
scheduler-0                 0/8     Init:8/17    0          6m35s
singleton-blobstore-0       0/6     Init:6/11    0          6m46s
tcp-router-0                0/5     Init:5/11    0          6m37s
uaa-0                       0/6     Init:8/13    0          6m36s</pre></div></div></div><div class="sect1 " id="sec-cap-tbl-rebuild-depl"><div class="titlepage"><div><div><h2 class="title"><span class="number">27.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Deleting and Rebuilding a Deployment</span> <a title="Permalink" class="permalink" href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-rebuild-depl">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_troubleshooting.xml</li><li><span class="ds-label">ID: </span>sec-cap-tbl-rebuild-depl</li></ul></div></div></div></div><p>
   There may be times when you want to delete and rebuild a deployment, for
   example when there are errors in your <code class="filename">kubecf-config-values.yaml</code> file, you wish to
   test configuration changes, or a deployment fails and you want to try it again.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Remove the <code class="literal">kubecf</code> release. All resources associated with
     the release of the <code class="literal">suse/kubecf</code> chart will be removed.
     Replace the example release name with the one used during your installation. 
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>helm uninstall <em class="replaceable ">kubecf</em></pre></div></li><li class="step "><p>
     Remove the <code class="literal">kubecf</code> namespace. Replace with the namespace
     where the <code class="literal">suse/kubecf</code> chart was installed.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl delete namespace <em class="replaceable ">kubecf</em></pre></div></li><li class="step "><p>
     Remove the <code class="literal">cf-operator</code> release. All resources associated
     with the release of the <code class="literal">suse/cf-operator</code> chart will be
     removed. Replace the example release name with the one used during your
     installation.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>helm uninstall <em class="replaceable ">cf-operator</em></pre></div></li><li class="step "><p>
     Remove the <code class="literal">cf-operator</code> namespace. Replace with the namespace
     where the <code class="literal">suse/cf-operator</code> chart was installed.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl delete namespace <em class="replaceable ">cf-operator</em></pre></div></li><li class="step "><p>
     Verify all of the releases are removed.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>helm list --all-namespaces</pre></div></li><li class="step "><p>
     Verify all of the namespaces are removed.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get namespaces</pre></div></li></ol></div></div></div><div class="sect1 " id="sec-cap-tbl-kubectl-queries"><div class="titlepage"><div><div><h2 class="title"><span class="number">27.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Querying with Kubectl</span> <a title="Permalink" class="permalink" href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-kubectl-queries">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_troubleshooting.xml</li><li><span class="ds-label">ID: </span>sec-cap-tbl-kubectl-queries</li></ul></div></div></div></div><p>
   You can safely query with <code class="command">kubectl</code> to get information
   about resources inside your Kubernetes cluster. <code class="command">kubectl cluster-info
   dump | tee clusterinfo.txt</code> outputs a large amount of information
   about the Kubernetes master and cluster services to a text file.
  </p><p>
   The following commands give more targeted information about your cluster.
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     List all cluster resources:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get all --all-namespaces</pre></div></li><li class="listitem "><p>
     List all of your running pods:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get pods --all-namespaces</pre></div></li><li class="listitem "><p>
     List all of your running pods, their internal IP addresses, and which
     Kubernetes nodes they are running on:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get pods --all-namespaces --output wide</pre></div></li><li class="listitem "><p>
     See all pods, including those with Completed or Failed statuses:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get pods --show-all --all-namespaces</pre></div></li><li class="listitem "><p>
     List pods in one namespace:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get pods --namespace kubecf</pre></div></li><li class="listitem "><p>
     Get detailed information about one pod:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl describe --namespace kubecf po/diego-cell-0</pre></div></li><li class="listitem "><p>
     Read the log file of a pod:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl logs --namespace kubecf po/diego-cell-0</pre></div></li><li class="listitem "><p>
     List all Kubernetes nodes, then print detailed information about a single
     node:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get nodes
<code class="prompt user">tux &gt; </code>kubectl describe node 6a2752b6fab54bb889029f60de6fa4d5.infra.caasp.local</pre></div></li><li class="listitem "><p>
     List all containers in all namespaces, formatted for readability:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get pods --all-namespaces --output jsonpath="{..image}" |\
tr -s '[[:space:]]' '\n' |\
sort |\
uniq -c</pre></div></li><li class="listitem "><p>
     These two commands check node capacities, to verify that there are enough
     resources for the pods:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl get nodes --output yaml | grep '\sname\|cpu\|memory'
<code class="prompt user">tux &gt; </code>kubectl get nodes --output json | \
jq '.items[] | {name: .metadata.name, cap: .status.capacity}'</pre></div></li></ul></div></div><div class="sect1 " id="sec-cap-tbl-admission-webhook"><div class="titlepage"><div><div><h2 class="title"><span class="number">27.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Admission webhook denied</span> <a title="Permalink" class="permalink" href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-admission-webhook">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_troubleshooting.xml</li><li><span class="ds-label">ID: </span>sec-cap-tbl-admission-webhook</li></ul></div></div></div></div><p>
    When switching back to Diego from Eirini, the error below can occur:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>helm install <em class="replaceable ">kubecf</em> suse/kubecf --namespace <em class="replaceable ">kubecf</em> --values kubecf-config-values.yaml
Error: admission webhook "validate-boshdeployment.quarks.cloudfoundry.org" denied the request: Failed to resolve manifest: Failed to interpolate ops 'kubecf-user-provided-properties' for manifest 'kubecf': Applying ops on manifest obj failed in interpolator: Expected to find exactly one matching array item for path '/instance_groups/name=eirini' but found 0</pre></div><p>
    To avoid this error, remove the <code class="literal">eirini-persi-broker</code> configuration
    before running the command.
  </p></div><div class="sect1 " id="sec-cap-tbl-helm-namespace"><div class="titlepage"><div><div><h2 class="title"><span class="number">27.7 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Namespace does not exist</span> <a title="Permalink" class="permalink" href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-helm-namespace">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_troubleshooting.xml</li><li><span class="ds-label">ID: </span>sec-cap-tbl-helm-namespace</li></ul></div></div></div></div><p>
    When running a Helm command, an error occurs stating that a namespace does not
    exist. To avoid this error, create the namespace manually with <code class="command">kubectl</code>; before
    running the command:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>kubectl create namespace <em class="replaceable ">name</em></pre></div></div><div class="sect1 " id="sec-cap-tbl-log-cache-memory"><div class="titlepage"><div><div><h2 class="title"><span class="number">27.8 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Log-cache Memory Allocation Issue</span> <a title="Permalink" class="permalink" href="cha-cap-depl-troubleshooting.html#sec-cap-tbl-log-cache-memory">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_troubleshooting.xml</li><li><span class="ds-label">ID: </span>sec-cap-tbl-log-cache-memory</li></ul></div></div></div></div><p>
   The log-cache component currently has a memory allocation issue where the node
   memory available is reported instead of the one assigned to the container under
   cgroups. In such a situation, log-cache would start allocating memory based on
   these values, causing a varying range of issues (OOMKills, performance
   degradation, etc.). To address this issue, node affinity must be used to tie
   log-cache to nodes of a uniform size, and then declaring the cache percentage
   based on that number. A limit of 3% has been identified as sufficient.
  </p><p>
   Add the following to your <code class="filename">kubecf-config-values.yaml</code>. In the node affinity
   configuration, the values for <code class="literal">key</code> and
   <code class="literal">values</code> may need to be changed depending on how notes in
   your cluster are labeled. For more information on labels, see
   <a class="link" href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#built-in-node-labels" target="_blank">https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#built-in-node-labels</a>.
  </p><div class="verbatim-wrap"><pre class="screen">properties:
  log-cache:
    log-cache:
      memory_limit_percent: 3

operations:
  inline:
  - type: replace
    path: /instance_groups/name=log-cache/env?/bosh/agent/settings/affinity
    value:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: <em class="replaceable ">kubernetes.io/hostname</em>
              operator: In
              values:
              - <em class="replaceable ">LABEL_VALUE_OF_NODE</em></pre></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="bk01apa.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Appendix A </span>Appendix</span></a><a class="nav-link" href="part-cap-troubleshooting.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Part V </span>Troubleshooting</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2022 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>
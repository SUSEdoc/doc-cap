<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Upgrading SUSE Cloud Application Platform | Deployment, Administration, and User Guides | SUSE Cloud Application Platform 2.1.1</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 3.2.0 (https://opensuse.github.io/daps) using SUSE XSL Stylesheets 2.81.0 (based on DocBook XSL Stylesheets 1.79.2) - chunked" /><meta name="product-name" content="SUSE Cloud Application Platform" /><meta name="product-number" content="2.1.1" /><meta name="book-title" content="Deployment, Administration, and User Guides" /><meta name="chapter-title" content="Chapter 13. Upgrading SUSE Cloud Application Platform" /><meta name="description" content="SUSE Cloud Application Platform upgrades are delivered as container images from the SUSE registry and applied with Helm." /><meta name="tracker-url" content="https://github.com/SUSE/doc-cap/issues/new" /><meta name="tracker-type" content="gh" /><meta name="tracker-gh-assignee" content="btat" /><meta name="tracker-gh-labels" content="bug,low priority" /><link rel="home" href="index.html" title="SUSE Cloud Application Platform 2.1.1 Documentation" /><link rel="up" href="part-cap-administration.html" title="Part III. SUSE Cloud Application Platform Administration" /><link rel="prev" href="part-cap-administration.html" title="Part III. SUSE Cloud Application Platform Administration" /><link rel="next" href="cha-cap-configuration-changes.html" title="Chapter 14. Configuration Changes" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css"></link>');
}
else {
  document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Cloud Application Platform 2.1.1 Documentation"><span class="book-icon">SUSE Cloud Application Platform 2.1.1 Documentation</span></a><span> › </span><a class="crumb" href="book-cap-guides.html">Deployment, Administration, and User Guides</a><span> › </span><a class="crumb" href="part-cap-administration.html">SUSE Cloud Application Platform Administration</a><span> › </span><a class="crumb" href="cha-cap-upgrade.html">Upgrading SUSE Cloud Application Platform</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Deployment, Administration, and User Guides</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-deployment.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part-cap-overview.html"><span class="number">I </span><span class="name">Overview of SUSE Cloud Application Platform</span></a><ol><li class="inactive"><a href="cha-cap-overview.html"><span class="number">1 </span><span class="name">About SUSE Cloud Application Platform</span></a></li><li class="inactive"><a href="cha-cap-depl-kube-requirements.html"><span class="number">2 </span><span class="name">Other Kubernetes Systems</span></a></li></ol></li><li class="inactive"><a href="part-cap-deployment.html"><span class="number">II </span><span class="name">Deploying SUSE Cloud Application Platform</span></a><ol><li class="inactive"><a href="cha-cap-depl-notes.html"><span class="number">3 </span><span class="name">Deployment and Administration Notes</span></a></li><li class="inactive"><a href="cha-cap-depl-caasp.html"><span class="number">4 </span><span class="name">Deploying SUSE Cloud Application Platform on SUSE CaaS Platform</span></a></li><li class="inactive"><a href="cha-cap-depl-aks.html"><span class="number">5 </span><span class="name">Deploying SUSE Cloud Application Platform on Microsoft Azure Kubernetes Service (AKS)</span></a></li><li class="inactive"><a href="cha-cap-depl-eks.html"><span class="number">6 </span><span class="name">Deploying SUSE Cloud Application Platform on Amazon Elastic Kubernetes Service (EKS)</span></a></li><li class="inactive"><a href="cha-cap-depl-gke.html"><span class="number">7 </span><span class="name">Deploying SUSE Cloud Application Platform on Google Kubernetes Engine (GKE)</span></a></li><li class="inactive"><a href="cha-cap-install-stratos.html"><span class="number">8 </span><span class="name">Installing the Stratos Web Console</span></a></li><li class="inactive"><a href="cha-cap-depl-eirini.html"><span class="number">9 </span><span class="name">Eirini</span></a></li><li class="inactive"><a href="cha-cap-depl-terraform.html"><span class="number">10 </span><span class="name">Deploying SUSE Cloud Application Platform Using Terraform</span></a></li><li class="inactive"><a href="cha-cap-depl-air-gap-registry.html"><span class="number">11 </span><span class="name">Setting Up a Registry for an Air Gapped Environment</span></a></li><li class="inactive"><a href="cha-cap-depl-private-registry.html"><span class="number">12 </span><span class="name">SUSE Private Registry</span></a></li></ol></li><li class="inactive"><a href="part-cap-administration.html"><span class="number">III </span><span class="name">SUSE Cloud Application Platform Administration</span></a><ol><li class="inactive"><a href="cha-cap-upgrade.html"><span class="number">13 </span><span class="name">Upgrading SUSE Cloud Application Platform</span></a></li><li class="inactive"><a href="cha-cap-configuration-changes.html"><span class="number">14 </span><span class="name">Configuration Changes</span></a></li><li class="inactive"><a href="cha-cap-create-admin-user.html"><span class="number">15 </span><span class="name">Creating Admin Users</span></a></li><li class="inactive"><a href="cha-cap-manage-passwords.html"><span class="number">16 </span><span class="name">Managing Passwords</span></a></li><li class="inactive"><a href="cha-cap-uaa-ui.html"><span class="number">17 </span><span class="name">Accessing the UAA User Interface</span></a></li><li class="inactive"><a href="cha-cap-memory-limits.html"><span class="number">18 </span><span class="name">Container Memory Limits and Requests</span></a></li><li class="inactive"><a href="cha-cap-ccdb-secret-rotation.html"><span class="number">19 </span><span class="name">Cloud Controller Database Secret Rotation</span></a></li><li class="inactive"><a href="cha-cap-secrets-rotation.html"><span class="number">20 </span><span class="name">Rotating Automatically Generated Secrets</span></a></li><li class="inactive"><a href="cha-cap-backup-restore.html"><span class="number">21 </span><span class="name">Backup and Restore</span></a></li><li class="inactive"><a href="cha-cap-service-brokers.html"><span class="number">22 </span><span class="name">Service Brokers</span></a></li><li class="inactive"><a href="cha-cap-app-autoscaler.html"><span class="number">23 </span><span class="name">App-AutoScaler</span></a></li><li class="inactive"><a href="cha-cap-credhub.html"><span class="number">24 </span><span class="name">Integrating CredHub with SUSE Cloud Application Platform</span></a></li><li class="inactive"><a href="cha-cap-buildpacks.html"><span class="number">25 </span><span class="name">Buildpacks</span></a></li></ol></li><li class="inactive"><a href="part-cap-user-guide.html"><span class="number">IV </span><span class="name">SUSE Cloud Application Platform User Guide</span></a><ol><li class="inactive"><a href="cha-cap-cf-cli.html"><span class="number">26 </span><span class="name">Deploying and Managing Applications with the Cloud Foundry Client</span></a></li></ol></li><li class="inactive"><a href="part-cap-troubleshooting.html"><span class="number">V </span><span class="name">Troubleshooting</span></a><ol><li class="inactive"><a href="cha-cap-depl-troubleshooting.html"><span class="number">27 </span><span class="name">Troubleshooting</span></a></li></ol></li><li class="inactive"><a href="bk01apa.html"><span class="number">A </span><span class="name">Appendix</span></a></li><li class="inactive"><a href="bk01apb.html"><span class="number">B </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Part III. SUSE Cloud Application Platform Administration" href="part-cap-administration.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 14. Configuration Changes" href="cha-cap-configuration-changes.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Cloud Application Platform 2.1.1 Documentation"><span class="book-icon">SUSE Cloud Application Platform 2.1.1 Documentation</span></a><span> › </span><a class="crumb" href="book-cap-guides.html">Deployment, Administration, and User Guides</a><span> › </span><a class="crumb" href="part-cap-administration.html">SUSE Cloud Application Platform Administration</a><span> › </span><a class="crumb" href="cha-cap-upgrade.html">Upgrading SUSE Cloud Application Platform</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Part III. SUSE Cloud Application Platform Administration" href="part-cap-administration.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 14. Configuration Changes" href="cha-cap-configuration-changes.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-cap-upgrade"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname ">SUSE Cloud Application Platform</span> <span class="productnumber ">2.1.1</span></div><div><h2 class="title"><span class="number">13 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Upgrading SUSE Cloud Application Platform</span> <a title="Permalink" class="permalink" href="cha-cap-upgrade.html#">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_admin_upgrade.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-cap-upgrade.html#sec-cap-upgrade-considerations"><span class="number">13.1 </span><span class="name">Important Considerations</span></a></span></dt><dt><span class="sect1"><a href="cha-cap-upgrade.html#sec-cap-update"><span class="number">13.2 </span><span class="name">Upgrading SUSE Cloud Application Platform</span></a></span></dt></dl></div></div><p>
  SUSE Cloud Application Platform upgrades are delivered as container images from the SUSE
  registry and applied with Helm.
 </p><p>
   For additional upgrade information, always review the release notes
   published at
   <a class="link" href="https://www.suse.com/releasenotes/x86_64/SUSE-CAP/2/" target="_blank">https://www.suse.com/releasenotes/x86_64/SUSE-CAP/2/</a>.
 </p><div class="sect1 " id="sec-cap-upgrade-considerations"><div class="titlepage"><div><div><h2 class="title"><span class="number">13.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Important Considerations</span> <a title="Permalink" class="permalink" href="cha-cap-upgrade.html#sec-cap-upgrade-considerations">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_admin_upgrade.xml</li><li><span class="ds-label">ID: </span>sec-cap-upgrade-considerations</li></ul></div></div></div></div><p>
   Before performing an upgrade, be sure to take note of the following:
  </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.3.5.3.4.3.1"><span class="term ">Perform Upgrades in Sequence</span></dt><dd><p>
      Cloud Application Platform only supports upgrading releases in sequential order. If there are
      any intermediate releases between your current release and your target
      release, they must be installed. Skipping releases is not supported.
     </p></dd><dt id="id-1.3.5.3.4.3.2"><span class="term ">Preserve Helm Value Changes during Upgrades</span></dt><dd><p>
      During a <code class="command">helm upgrade</code>, always ensure your
      <code class="filename">kubecf-config-values.yaml</code> file is passed. This will
      preserve any previously set Helm values while allowing additional
      Helm value changes to be made.
     </p></dd><dt id="id-1.3.5.3.4.3.3"><span class="term "><code class="command">helm rollback</code> Is Not Supported</span></dt><dd><p>
      <code class="command">helm rollback</code> is not supported in SUSE Cloud Application Platform or in
      upstream Cloud Foundry, and may break your cluster completely, because database
      migrations only run forward and cannot be reversed. Database schema can
      change over time. During upgrades both pods of the current and the next
      release may run concurrently, so the schema must stay compatible with the
      immediately previous release. But there is no way to guarantee such
      compatibility for future upgrades. One way to address this is to perform a
      full raw data backup and restore. (See
      <a class="xref" href="cha-cap-backup-restore.html#sec-cap-backup-restore-of-raw-data" title="21.2. Disaster Recovery through Raw Data Backup and Restore">Section 21.2, “Disaster Recovery through Raw Data Backup and Restore”</a>)
     </p></dd></dl></div></div><div class="sect1 " id="sec-cap-update"><div class="titlepage"><div><div><h2 class="title"><span class="number">13.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Upgrading SUSE Cloud Application Platform</span> <a title="Permalink" class="permalink" href="cha-cap-upgrade.html#sec-cap-update">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>cap_admin_upgrade.xml</li><li><span class="ds-label">ID: </span>sec-cap-update</li></ul></div></div></div></div><p>
   The supported upgrade method is to install all upgrades, in order. Skipping
   releases is not supported. This table matches the Helm chart versions to
   each release:
  </p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col /><col /><col /><col /><col /><col /><col /><col /><col /></colgroup><thead><tr><th>CAP Release</th><th>cf-operator Helm Chart Version</th><th>KubeCF Helm Chart Version</th><th>Stratos Helm Chart Version</th><th>Stratos Metrics Helm Chart Version</th><th>Minimum Kubernetes Version Required</th><th>CF API Implemented</th><th>Known Compatible CF CLI Version</th><th>CF CLI URL</th></tr></thead><tbody><tr><td>2.1.1 (current release)</td><td>7.2.1+0.gaeb6ef3</td><td>2.7.13</td><td>4.4.1</td><td>1.3.0</td><td>1.14</td><td>2.144.0</td><td>6.49.0</td><td><a class="link" href="https://github.com/cloudfoundry/cli/releases/tag/v6.49.0" target="_blank">https://github.com/cloudfoundry/cli/releases/tag/v6.49.0</a></td></tr><tr><td>2.1.0</td><td>6.1.17+0.gec409fd7</td><td>2.5.8</td><td>4.2.0</td><td>1.3.0</td><td>1.14</td><td>2.144.0</td><td>6.49.0</td><td><a class="link" href="https://github.com/cloudfoundry/cli/releases/tag/v6.49.0" target="_blank">https://github.com/cloudfoundry/cli/releases/tag/v6.49.0</a></td></tr><tr><td>2.0.1</td><td>4.5.13+.gd4738712</td><td>2.2.3</td><td>4.0.1</td><td>1.2.1</td><td>1.14</td><td>2.144.0</td><td>6.49.0</td><td><a class="link" href="https://github.com/cloudfoundry/cli/releases/tag/v6.49.0" target="_blank">https://github.com/cloudfoundry/cli/releases/tag/v6.49.0</a></td></tr><tr><td>2.0</td><td>4.5.6+0.gffc6f942</td><td>2.2.2</td><td>3.2.1</td><td>1.2.1</td><td>1.14</td><td>2.144.0</td><td>6.49.0</td><td><a class="link" href="https://github.com/cloudfoundry/cli/releases/tag/v6.49.0" target="_blank">https://github.com/cloudfoundry/cli/releases/tag/v6.49.0</a></td></tr></tbody></table></div><p>
   Use <code class="command">helm list</code> to see the version of your installed release
   . Perform sequential upgrades until you reach the desired SUSE Cloud Application Platform
   release.
  </p><p>
   The example procedure below demonstrates how to upgrade to the current
   release. If you are not upgrading to the current release, replace the
   <code class="literal">version</code> with the version you intend to upgrade to.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Begin by upgrading cf-operator.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>helm upgrade <em class="replaceable ">cf-operator</em> suse/cf-operator \
--namespace <em class="replaceable ">cf-operator</em> \
--set "global.singleNamespace.name=<em class="replaceable ">kubecf</em>" \
--version 7.2.1+0.gaeb6ef3</pre></div></li><li class="step "><p>
    Wait until cf-operator is successfully upgraded before proceeding. Monitor
    the status of your cf-operator upgrade using the <code class="command">watch</code>
    command.
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>watch --color 'kubectl get pods --namespace <em class="replaceable ">cf-operator</em>'</pre></div></li><li class="step "><p>
     When the cf-operator upgrade is completed, upgrade KubeCF.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>helm upgrade <em class="replaceable ">kubecf</em> suse/kubecf \
--namespace <em class="replaceable ">kubecf</em> \
--values kubecf-config-values.yaml \
--version 2.7.13</pre></div></li><li class="step "><p>
     Monitor the status of your KubeCF upgrade using the <code class="command">watch</code>
     command.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>watch --color 'kubectl get pods --namespace <em class="replaceable ">kubecf</em>'</pre></div></li></ol></div></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha-cap-configuration-changes.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 14 </span>Configuration Changes</span></a><a class="nav-link" href="part-cap-administration.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Part III </span>SUSE Cloud Application Platform Administration</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2021 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>